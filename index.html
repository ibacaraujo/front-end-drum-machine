<!DOCTYPE html>
<html>
<head>
  <title>Drum Machine</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
  <script src="https://unpkg.com/react@15/dist/react.js"></script>
  <script src="https://unpkg.com/react-dom@15/dist/react-dom.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
  <script type="text/babel">

  	const data = [
  		{ id: 'Q', letter: 'Q', src: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-1.mp3'},
  		{ id: 'W', letter: 'W', src: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-2.mp3'},
  		{ id: 'E', letter: 'E', src: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-3.mp3'},
  		{ id: 'A', letter: 'A', src: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-4_1.mp3'},
  		{ id: 'S', letter: 'S', src: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-6.mp3'},
  		{ id: 'D', letter: 'D', src: 'https://s3.amazonaws.com/freecodecamp/drums/Dsc_Oh.mp3'},
  		{ id: 'Z', letter: 'Z', src: 'https://s3.amazonaws.com/freecodecamp/drums/Kick_n_Hat.mp3'},
  		{ id: 'X', letter: 'X', src: 'https://s3.amazonaws.com/freecodecamp/drums/RP4_KICK_1.mp3'},
  		{ id: 'C', letter: 'C', src: 'https://s3.amazonaws.com/freecodecamp/drums/Cev_H2.mp3'},
  	];

    class App extends React.Component {
	  constructor(props) {
	    super(props);
	    this.state = {
		  display: "Enjoy your own beats!"
		}
		this.handleDisplay = this.handleDisplay.bind(this);
	  }
	  

	  handleDisplay(display) {
	  	this.setState({
	  		display: display
	  	});
	  }
	  
	  render() {
	    {/* To render the drum machine composed by display and 
		drum pads */}
	    return (
	      <div id='drum-machine'>
	        <h2 id="display">{this.state.display}</h2>
	        <div id='drum-pads'>
	        	{data.map(d => (
	          <DrumPad
	          	id={d.id}
	          	letter={d.letter}
	          	src={d.src}
	          	handleDisplay={this.handleDisplay}
	          />
	        ))}</div>
	      </div>
	      
	    );
	  }
	};
	
	class DrumPad extends React.Component {
	  constructor(props) {
	    super(props);

	    this.playAudioClip = this.playAudioClip.bind(this);
	    this.handleKeyPress = this.handleKeyPress.bind(this);
	  }

	  playAudioClip() {
        var audio = new Audio(this.props.src);
        audio.play();
        audio.currentTime = 0;
        this.props.handleDisplay(this.props.id);
	  }
	  
	  componentDidMount() {
	    document.addEventListener('keydown', this.handleKeyPress);
	  }
	  
	  componentWillUnmount() {
	    document.removeEventListener('keydown', this.handleKeyPress);
	  }

	  handleKeyPress(e) {
        if (e.keyCode === this.props.keyCode) {
          this.playAudioClip();
        }
	  }
	  
	  render() {
	    return (
	      <div 
	      	className="drum-pad" 
	      	id={this.props.id}
	      	onClick={this.playAudioClip}>
	       	<p>{this.props.letter}</p>
		      <audio 
		      	ref={ref => this.audio = ref}
		      	className='clip' 
		      	src={this.props.src} 
		      	id={this.props.letter}>
		      </audio>
		    </div>
	    );
	  }
    };
    
    ReactDOM.render(
      <App />,
      document.getElementById('root')
    );
  </script>
  <style>
    #title {
	  	font-family: 'Source Sans Pro', sans-serif;
	  	font-size: 80px;
		}
	
		div {
	  	font-family: 'Source Sans Prop', sans-serif;
	  	font-size: 48px;
		}

		.drum-pad {
  		border: 1px solid black;
  		height: 15vh;
  		width: 15vh;
  		display: flex;
  		justify-content: center;
  		align-items: center;
  		margin-right: 1vw;
  		background-color: white;
		}

		#drum-pads {
  		height: 75vh;
  		width: 100vw;
  		display: flex;
  		justify-content: center;
  		align-items: center;
		}

		#display {
			text-align: center;
		}
  </style>
</head>
<body>

	<h1 id="title" class="text-center">Drum Machine</h1>
  <div id="root"></div>

  <!-- Load the bundle to test user stories -->
  <script src="https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js"></script>
</body>
</html>
